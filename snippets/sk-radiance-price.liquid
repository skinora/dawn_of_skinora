{%- liquid
  assign target = product.selected_or_first_available_variant
  assign compare_at_price = target.compare_at_price
  assign price = target.price | default: 1999
  assign available = target.available | default: false
  assign money_price = price | money
  if settings.currency_code_enabled
    assign money_price = price | money_with_currency
  endif

  if target == product.selected_or_first_available_variant
    if product.compare_at_price > product.price
      assign on_sale = true
    else
      assign on_sale = false
    endif
  else
    assign on_sale = false
  endif
-%}

<div class="sk-radiance-price sk-radiance-price--{{ price_class }} sk-radiance-price--{{ section.settings.price_size }} sk-radiance-price--{{ section.settings.price_layout }} sk-radiance-price--{{ section.settings.price_alignment }} sk-radiance-price--unavailable-{{ available }}">
  <div class="sk-radiance-price__container">
    <div class="sk-radiance-price__wrapper">
      {%- comment -%}
        Explanation of description list:
        - div.price__regular: Displayed when there are no variants on sale
        - div.price__sale: Displayed when a variant is a sale
      {%- endcomment -%}
      {% comment %}
        <div class="sk-radiance-price__regular">
          <span class="visually-hidden visually-hidden--inline">{{ 'products.product.price.regular_price' | t }}</span>
          <span class="sk-radiance-price-item sk-radiance-price-item--regular">
            {{ money_price }}
          </span>
        </div>
      {% endcomment %}
      <div class="sk-radiance-price__sale">
        {%- unless product.price_varies == false and product.compare_at_price_varies %}
          <span class="visually-hidden visually-hidden--inline">{{ 'products.product.price.regular_price' | t }}</span>
          <span>
            <s class="sk-radiance-price-item sk-radiance-price-item--regular">
              {% if settings.currency_code_enabled %}
                {{ compare_at_price | money_with_currency }}
              {% else %}
                {{ compare_at_price | money }}
              {% endif %}
            </s>
          </span>
        {%- endunless -%}
        <span class="visually-hidden visually-hidden--inline">{{ 'products.product.price.sale_price' | t }}</span>
        <span class="sk-radiance-price-item sk-radiance-price-item--sale sk-radiance-price-item--last">
          {{ money_price }}
        </span>
      </div>
      <small class="sk-radiance-price__availability sk-radiance-price__availability--{{ available }}">
        {%- if show_badges -%}
          {%- if available == false -%}
            {{ 'products.product.sold_out' | t }}
          {%- elsif on_sale -%}
            {{ 'products.product.on_sale' | t }}
          {%- endif -%}
        {%- endif -%}
      </small>
    </div>
    {%- if show_badges -%}
      <span class="sk-radiance-badges sk-radiance-badges--{{ section.settings.badge_position }} sk-radiance-badges--{{ section.settings.badge_design }}">
        {%- if available == false -%}
          <span class="sk-radiance-badge sk-radiance-badge--sold-out">
            <span class="sk-radiance-badge__text">{{ 'products.product.sold_out' | t }}</span>
          </span>
        {%- elsif on_sale -%}
          <span class="sk-radiance-badge sk-radiance-badge--sale">
            <span class="sk-radiance-badge__text">
              {%- if product.compare_at_price > product.price -%}
                {%- assign discount_percentage = product.compare_at_price
                  | minus: product.price
                  | times: 100
                  | divided_by: product.compare_at_price
                -%}
                -{{ discount_percentage }}%
              {%- else -%}
                {{ 'products.product.on_sale' | t }}
              {%- endif -%}
            </span>
          </span>
        {%- endif -%}
      </span>
    {%- endif -%}
  </div>
  {%- comment -%} Pickup availability removed - snippet not available {%- endcomment -%}
</div>

{%- if product.quantity_price_breaks_configured? -%}
  <div class="sk-radiance-volume-pricing sk-radiance-volume-pricing--{{ section.settings.volume_pricing_style }}">
    <div class="sk-radiance-volume-pricing__container">
      <span class="sk-radiance-volume-pricing__title">{{ 'products.product.volume_pricing.title' | t }}</span>
      <ul class="sk-radiance-volume-pricing__list">
        {%- for price_break in product.selected_or_first_available_variant.quantity_price_breaks -%}
          <li class="sk-radiance-volume-pricing__item">
            <span class="sk-radiance-volume-pricing__quantity">{{ price_break.minimum_quantity }}+</span>
            <span class="sk-radiance-volume-pricing__price">
              {%- if settings.currency_code_enabled -%}
                {{ price_break.price | money_with_currency }}
              {%- else -%}
                {{ price_break.price | money }}
              {%- endif -%}
            </span>
          </li>
        {%- endfor -%}
      </ul>
    </div>
  </div>
{%- endif -%}
