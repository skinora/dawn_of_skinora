{{ 'section-sk-radiance-product.css' | asset_url | stylesheet_tag }}

<style>
  .sk-radiance-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 0.6rem;
    margin: 1rem 0;
  }
  .sk-pill {
    border: 2px solid #d4d4dc;
    border-radius: 999px;
    padding: 0.6rem 1.2rem;
    font-weight: 600;
    font-size: 0.95rem;
    background: #fff;
  }
</style>

{%- assign product_info_reference = product.metafields.custom.product_info -%}
{%- assign product_info_entry = blank -%}
{%- assign hero_heading = '' -%}
{%- assign hero_subheading = '' -%}
{%- assign hero_eyebrow = '' -%}
{%- assign hero_image = blank -%}
{%- assign hero_content_meta = blank -%}
{%- assign hero_pills_source = blank -%}
{%- assign hero_trust_badges = blank -%}
{%- assign has_hero_content = false -%}
{%- assign show_hero = false -%}
{%- assign show_trust_badges = false -%}
{%- assign product_form_id = 'product-form-' | append: section.id -%}

{%- if product_info_reference != blank and product_info_reference.value != blank -%}
  {%- assign product_info_entry = product_info_reference.value -%}
  {%- assign hero_heading = product_info_entry.radiance_heading.value | default: '' -%}
  {%- assign hero_subheading = product_info_entry.radiance_subheading.value | default: '' -%}
  {%- assign hero_eyebrow = product_info_entry.radiance_eyebrow.value | default: '' -%}
  {%- assign hero_image = product_info_entry.radiance_image.value -%}
  {%- assign hero_content_meta = product_info_entry.radiance_content -%}
  {%- assign hero_pills_source = product_info_entry.radiance_pills.value -%}
  {%- assign hero_trust_badges = product_info_entry.trust_badges -%}
  {%- if hero_content_meta != blank and hero_content_meta.value != blank -%}
    {%- assign has_hero_content = true -%}
  {%- endif -%}
  {%- if hero_heading != blank
    or hero_subheading != blank
    or hero_eyebrow != blank
    or hero_image != blank
    or has_hero_content
  -%}
    {%- assign show_hero = true -%}
  {%- endif -%}
  {%- if hero_trust_badges != blank and hero_trust_badges.value != blank -%}
    {%- assign show_trust_badges = true -%}
  {%- endif -%}
{%- endif -%}

<product-info
  id="MainProduct-{{ section.id }}"
  class="section-{{ section.id }}-padding"
  data-product-id="{{ product.id }}"
  data-url="{{ product.url }}"
>
  <div class="page-width">
    <!--
      =========================
           HERO SECTION
      ==========================
    -->
    {% if show_hero %}
      <section class="sk-product-radiance-hero">
        <div class="sk-hero-grid">
          {% if hero_image != blank %}
            <div class="sk-hero-image">
              <img
                src="{{ hero_image | image_url: width: 720 }}"
                alt="{{ hero_heading | default: product.title | escape }}"
                width="720"
                height="720"
                loading="lazy"
              >
            </div>
          {% endif %}

          <div class="sk-hero-content">
            {% if hero_eyebrow != blank %}
              <p class="sk-eyebrow">
                {{ hero_eyebrow }}
              </p>
            {% endif %}

            <h1 class="sk-product-title">
              {{ hero_heading | default: product.title }}
            </h1>

            {% if hero_subheading != blank %}
              <p class="sk-product-subtitle">
                {{ hero_subheading }}
              </p>
            {% endif %}

            <!-- Reviews (Okendo) -->
            <div class="sk-product-reviews">
              {% for block in section.blocks %}
                {% if block.type == '@app' %}
                  {% render block %}
                {% endif %}
              {% endfor %}
            </div>

            {% if has_hero_content %}
              <div class="sk-hero-copy">
                {{ hero_content_meta | metafield_tag }}
              </div>
            {% endif %}
          </div>
        </div>
      </section>
    {% endif %}

    <!--
      =========================
           PRODUCT CORE
      ==========================
    -->
    <section class="sk-product-core">
      <!-- PRICE -->
      <div class="sk-product-price">
        {% render 'sk-radiance-price',
          product: product,
          use_variant: true,
          show_badges: true,
          price_class: 'price--large'
        %}
      </div>

      <!-- PILLS -->
      {% if hero_pills_source != blank %}
        <div class="sk-radiance-pills" role="list">
          {% assign pills = hero_pills_source | split: '\n' %}
          {% for pill in pills %}
            {% if pill != blank %}
              <span class="sk-pill">{{ pill | strip }}</span>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}

      <!-- VARIANTS -->
      {% if product.variants.size > 1 %}
        {% render 'sk-radiance-product-variant-picker', product: product, product_form_id: product_form_id %}
      {% endif %}

      <!-- QUANTITY -->
      {% render 'sk-radiance-quantity', product: product, product_form_id: product_form_id, section: section %}

      <!-- BUY BUTTON -->
      {% render 'sk-radiance-buy-buttons', product: product, product_form_id: product_form_id %}

      <!-- TRUST BADGES -->
      {% if show_trust_badges %}
        <div class="sk-trust-badges">
          {{ hero_trust_badges | metafield_tag }}
        </div>
      {% endif %}
    </section>
  </div>

  <!-- JSON-LD -->
  <script type="application/ld+json">
    {{ product | structured_data }}
  </script>
</product-info>

{% schema %}
{
  "name": "SK Radiance Product",
  "tag": "section",
  "class": "section",
  "blocks": [
    {
      "type": "@app"
    }
  ],
  "settings": []
}
{% endschema %}
