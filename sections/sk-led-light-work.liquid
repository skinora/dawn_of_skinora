<style>
  /* === SECTION WRAPPER === */
  .sk-wavelengths {
    --sk-color-brand: #30273e;
    --sk-color-neutral: #6c6c6c;
    --sk-color-border: #e6e6e6;
    --sk-color-body: #333333;
    --sk-color-tag-text: #ffffff;
    padding: 4rem 0 6rem;
    background: #f2f2f2;
  }

  .sk-header__section {
    text-align: center;
    margin-bottom: 3rem;
    color: inherit;
  }

  .sk-wavelengths__eyebrow {
    margin: 0 0 0.5rem;
    font-size: 12px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--sk-color-neutral);
    font-weight: 500;
    text-align: center;
  }

  /* === DESKTOP GRID === */
  .sk-wavelengths__grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 48px;
    max-width: 1800px;
    margin: 0 auto;
    padding: 0 24px;
    align-items: start;
  }

  .sk-wavelengths__slider {
    display: none;
  }

  .sk-wavelengths__empty {
    text-align: center;
    color: var(--sk-color-neutral);
    font-size: 14px;
    margin-top: 1rem;
  }

  /* === CARD WRAPPER === */
  .sk-wavelength {
    background: #f2f2f2;
    border-radius: 8px;
    padding: 32px;
    border: none;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    box-shadow: none;
    position: relative;
    overflow: visible;
  }

  /* === IMAGE WRAPPER === */
  .sk-wavelength__visual {
    width: 100%;
    max-width: 550px;
    margin: 0 auto 16px;
    aspect-ratio: 1 / 0.75;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .sk-wavelength__visual img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: block;
    border-radius: 8px !important;
  }

  .sk-tag {
    position: absolute;
    top: -16px;
    left: 50%;
    transform: translateX(-50%);
    display: inline-block;
    font-size: 12px;
    font-weight: 500;
    letter-spacing: 1px;
    padding: 4px 10px;
    color: var(--sk-color-tag-text);
    background: var(--sk-color-brand);
    border-radius: 4px;
    text-transform: uppercase;
    white-space: nowrap;
  }

  .sk-wavelength__eyebrow {
    margin: 0 0 8px;
    font-size: 12px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--sk-color-neutral);
    font-weight: 500;
  }

  /* === TITLES === */
  .sk-wavelength__title {
    font-size: 22px;
    font-weight: 600;
    margin: 0 0 12px;
    line-height: 1.3;
    color: var(--sk-color-brand);
  }

  .sk-wavelength__svg-preview {
    width: 100%;
    max-width: 420px;
    margin: 0 auto 24px;
  }

  /* === BENEFITS LIST === */
  .sk-wavelength__benefits {
    list-style: none;
    padding: 0;
    margin: 0;
    text-align: left;
    margin-top: 0;
    width: 100%;
    max-width: 500px;
  }

  .sk-wavelength__benefits li {
    font-size: 16px;
    margin-bottom: 8px;
    display: flex;
    gap: 4px;
    align-items: flex-start;
    line-height: 1.3;
    color: var(--sk-color-body);
    font-weight: 400;
  }

  .sk-wavelength__benefits li::before {
    content: '';
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--sk-color-brand);
    margin-top: 6px;
  }

  /* === MOBILE SLIDER === */
  @media (max-width: 750px) {
    .sk-wavelengths__grid {
      display: none;
    }
    .sk-wavelengths__slider {
      display: block;
    }
    .sk-wavelength {
      padding: 24px 12px;
    }
    .sk-wavelength__visual {
      max-width: 420px;
    }
    .sk-wavelength__title {
      font-size: 20px;
    }
    .sk-wavelength__benefits li {
      font-size: 15px;
    }
  }
</style>

<section class="sk-wavelengths section--full-bleed sk-body-text--strong">
  <div class="page-width">
    {% if section.settings.sk_led_light_work_eyebrow != blank %}
      <p class="sk-wavelengths__eyebrow">
        {{ section.settings.sk_led_light_work_eyebrow }}
      </p>
    {% endif %}

    {% if section.settings.sk_led_light_work_heading != blank %}
      <h1 class="sk-header__section sk-section-heading sk-section-heading--h1 sk-heading-text--strong sk-heading-size--large">
        {{ section.settings.sk_led_light_work_heading }}
      </h1>
    {% endif %}

    {% liquid
      assign sk_metafield_handle = 'product.metafields.custom["led_light_work_cards"]'
    %}

    {% if product.metafields.custom.led_light_work_cards.value != blank %}
      {% assign sk_cards = product.metafields.custom.led_light_work_cards.value %}
      <!-- DESKTOP GRID -->
      <div class="sk-wavelengths__grid">
        {% for card in sk_cards %}
          {% liquid
            assign card_image = card.image.value | default: card.image
            assign card_eyebrow = card.eyebrow.value | default: card.eyebrow
            assign card_title = card.title.value | default: card.title
            assign title_parts = card_title | split: '|'
            assign card_primary_title = ''
            assign card_secondary_title = ''
            if title_parts.size > 1
              assign card_primary_title = title_parts[0] | strip
              assign card_secondary_title = title_parts[1] | strip
            else
              assign card_secondary_title = card_title | strip
            endif
            assign card_benefits = card.benefits.value | default: card.benefits
            assign card_highlight_tag = card.highlight_tag_text.value | default: card.highlight_tag_text
            assign card_show_highlight = card.show_highlight_text.value | default: card.show_highlight_text
            assign card_svg_file = card.svg.value | default: card.svg
            assign card_svg_inline = ''
            assign card_svg_image_url = ''
            if card_svg_file != blank
              if card_svg_file.media_type != blank
                assign card_svg_image_url = card_svg_file | image_url: width: 320
              else
                assign card_svg_text = card_svg_file | strip
                if card_svg_text contains '<svg'
                  assign card_svg_inline = card_svg_text
                else
                  assign card_svg_image_url = card_svg_text
                endif
              endif
            endif
          %}
          <div class="sk-wavelength">
            {% if card_show_highlight %}
              <span class="sk-tag">
                {{ card_highlight_tag | default: 'NY DYPTVIRKENDE BØLGELENGDE' }}
              </span>
            {% endif %}

            {% if card_image %}
              <div class="sk-wavelength__visual">
                <img
                  src="{{ card_image | image_url: width: 1000 }}"
                  alt="{{ card_title | default: 'Skinora LED lys' | escape }}"
                  loading="lazy"
                  width="{{ card_image.width | default: 1000 }}"
                  height="{{ card_image.height | default: 750 }}"
                >
              </div>
            {% endif %}

            {% if card_eyebrow != blank %}
              <p class="sk-wavelength__eyebrow">{{ card_eyebrow }}</p>
            {% endif %}

            {% if card_primary_title != blank or card_secondary_title != blank %}
              <h3 class="sk-wavelength__title">
                {% if card_primary_title != blank %}
                  {{ card_primary_title }}
                {% endif %}
                {% if card_primary_title != blank and card_secondary_title != blank %}
                  |
                {% endif %}
                {% if card_secondary_title != blank %}
                  <em>{{ card_secondary_title }}</em>
                {% endif %}
              </h3>
            {% endif %}

            {% if card_svg_inline != blank %}
              <div class="sk-wavelength__svg-preview">
                {{ card_svg_inline | raw }}
              </div>
            {% elsif card_svg_image_url != blank %}
              <div class="sk-wavelength__svg-preview">
                <img
                  src="{{ card_svg_image_url }}"
                  alt="{{ card_secondary_title | default: card_primary_title | default: 'Skinora LED illustrasjon' }}"
                  loading="lazy"
                  width="420"
                  height="420"
                >
              </div>
            {% endif %}

            {% if card_benefits != blank %}
              <ul class="sk-wavelength__benefits">
                {% assign items = card_benefits | newline_to_br | split: '<br />' %}
                {% for item in items %}
                  {% assign line = item | strip %}
                  {% if line != blank %}
                    <li>{{ line }}</li>
                  {% endif %}
                {% endfor %}
              </ul>
            {% endif %}
          </div>
        {% endfor %}
      </div>

      <!-- MOBILE SWIPER -->
      <div class="sk-wavelengths__slider sk-wavelengths-swiper-{{ section.id }}">
        <div class="swiper llw-swiper-{{ section.id }}">
          <div class="swiper-wrapper">
            {% for card in product.metafields.custom.led_light_work_cards.value %}
              {% liquid
                assign card_image = card.image.value | default: card.image
                assign card_eyebrow = card.eyebrow.value | default: card.eyebrow
                assign card_title = card.title.value | default: card.title
                assign title_parts = card_title | split: '|'
                assign card_primary_title = ''
                assign card_secondary_title = ''
                if title_parts.size > 1
                  assign card_primary_title = title_parts[0] | strip
                  assign card_secondary_title = title_parts[1] | strip
                else
                  assign card_secondary_title = card_title | strip
                endif
                assign card_benefits = card.benefits.value | default: card.benefits
                assign card_highlight_tag = card.highlight_tag_text.value | default: card.highlight_tag_text
                assign card_show_highlight = card.show_highlight_text.value | default: card.show_highlight_text
                assign card_svg_file = card.svg.value | default: card.svg
                assign card_svg_inline = ''
                assign card_svg_image_url = ''
                if card_svg_file != blank
                  if card_svg_file.media_type != blank
                    assign card_svg_image_url = card_svg_file | image_url: width: 320
                  else
                    assign card_svg_text = card_svg_file | strip
                    if card_svg_text contains '<svg'
                      assign card_svg_inline = card_svg_text
                    else
                      assign card_svg_image_url = card_svg_text
                    endif
                  endif
                endif
              %}
              <div class="swiper-slide">
                <div class="sk-wavelength">
                  {% if card_show_highlight %}
                    <span class="sk-tag">
                      {{ card_highlight_tag | default: 'NY DYPTVIRKENDE BØLGELENGDE' }}
                    </span>
                  {% endif %}

                  {% if card_image %}
                    <div class="sk-wavelength__visual">
                      <img
                        src="{{ card_image | image_url: width: 800 }}"
                        alt="{{ card_title | default: 'Skinora LED lys' | escape }}"
                        loading="lazy"
                        width="{{ card_image.width | default: 800 }}"
                        height="{{ card_image.height | default: 600 }}"
                      >
                    </div>
                  {% endif %}

                  {% if card_eyebrow != blank %}
                    <p class="sk-wavelength__eyebrow">{{ card_eyebrow }}</p>
                  {% endif %}

                  {% if card_primary_title != blank or card_secondary_title != blank %}
                    <h3 class="sk-wavelength__title">
                      {% if card_primary_title != blank %}
                        {{ card_primary_title }}
                      {% endif %}
                      {% if card_primary_title != blank and card_secondary_title != blank %}
                        |
                      {% endif %}
                      {% if card_secondary_title != blank %}
                        <em>{{ card_secondary_title }}</em>
                      {% endif %}
                    </h3>
                  {% endif %}

                  {% if card_svg_inline != blank %}
                    <div class="sk-wavelength__svg-preview">
                      {{ card_svg_inline | raw }}
                    </div>
                  {% elsif card_svg_image_url != blank %}
                    <div class="sk-wavelength__svg-preview">
                      <img
                        src="{{ card_svg_image_url }}"
                        alt="{{ card_secondary_title | default: card_primary_title | default: 'Skinora LED illustrasjon' }}"
                        loading="lazy"
                        width="420"
                        height="420"
                      >
                    </div>
                  {% endif %}

                  {% if card_benefits != blank %}
                    <ul class="sk-wavelength__benefits">
                      {% assign items = card_benefits | newline_to_br | split: '<br />' %}
                      {% for item in items %}
                        {% assign line = item | strip %}
                        {% if line != blank %}
                          <li>{{ line }}</li>
                        {% endif %}
                      {% endfor %}
                    </ul>
                  {% endif %}
                </div>
              </div>
            {% endfor %}
          </div>
          <div class="swiper-pagination"></div>
        </div>
    {% else %}
      {% if request.design_mode %}
        <p class="sk-wavelengths__empty">
          Ingen data funnet. Legg til metaobjekter på <code>{{ sk_metafield_handle }}</code> for å fylle ut kortene.
        </p>
      {% endif %}
    {% endif %}
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    var mql = window.matchMedia('(max-width: 750px)');
    var swiperInstance = null;
    var container = document.querySelector('.sk-wavelengths-swiper-{{ section.id }} .swiper');

    function setup() {
      if (!container) return;

      if (mql.matches && !swiperInstance) {
        swiperInstance = new Swiper(container, {
          slidesPerView: 1,
          spaceBetween: 20,
          pagination: {
            el: container.querySelector('.swiper-pagination'),
            clickable: true,
          },
        });
      } else if (!mql.matches && swiperInstance) {
        swiperInstance.destroy(true, true);
        swiperInstance = null;
      }
    }

    setup();
    mql.addEventListener('change', setup);
  });
</script>

{% schema %}
{
  "name": "SK Led Light Work",
  "settings": [
    {
      "type": "text",
      "id": "sk_led_light_work_eyebrow",
      "label": "Eyebrow label",
      "default": "VITENSKAPEN BAK SKINORA LED"
    },
    {
      "type": "text",
      "id": "sk_led_light_work_heading",
      "label": "Title",
      "default": "Hvordan Fungerer Skinora LED Lys"
    }
  ],
  "presets": [
    {
      "name": "SK Led Light Work"
    }
  ]
}
{% endschema %}
