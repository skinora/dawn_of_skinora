<style>
  /* === SECTION WRAPPER === */
  .sk-wavelengths {
    --sk-color-brand: #30273e;
    --sk-color-neutral: #6c6c6c;
    --sk-color-border: #e6e6e6;
    --sk-color-body: #333333;
    --sk-color-tag-text: #ffffff;
    padding: 4rem 0 6rem;
  }

  .sk-header__section {
    text-align: center;
    margin-bottom: 3rem;
    color: inherit;
  }

  .sk-wavelengths__eyebrow {
    margin: 0 0 0.5rem;
    font-size: 12px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--sk-color-neutral);
    font-weight: 500;
    text-align: center;
  }

  /* === DESKTOP GRID === */
  .sk-wavelengths__grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 48px;
    max-width: 1800px;
    margin: 0 auto;
    padding: 0 24px;
    align-items: start;
  }

  .sk-wavelengths__slider {
    display: none;
  }

  .sk-wavelengths__empty {
    text-align: center;
    color: var(--sk-color-neutral);
    font-size: 14px;
    margin-top: 1rem;
  }

  /* === CARD WRAPPER === */
  .sk-wavelength {
    background: #ffffff;
    border-radius: 8px;
    padding: 32px;
    border: 1px solid var(--sk-color-border);
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    box-shadow: none;
    position: relative;
    overflow: visible;
  }

  /* === IMAGE WRAPPER === */
  .sk-wavelength__visual {
    width: 100%;
    max-width: 550px;
    margin: 0 auto 16px;
    aspect-ratio: 1 / 0.75;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .sk-wavelength__visual img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: block;
    border-radius: 8px !important;
  }

  .sk-tag {
    position: absolute;
    top: -16px;
    left: 50%;
    transform: translateX(-50%);
    display: inline-block;
    font-size: 12px;
    font-weight: 500;
    letter-spacing: 1px;
    padding: 4px 10px;
    color: var(--sk-color-tag-text);
    background: var(--sk-color-brand);
    border-radius: 4px;
    text-transform: uppercase;
    white-space: nowrap;
  }

  .sk-wavelength__eyebrow {
    margin: 0 0 8px;
    font-size: 12px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--sk-color-neutral);
    font-weight: 500;
  }

  /* === TITLES === */
  .sk-wavelength__title {
    font-size: 22px;
    font-weight: 600;
    margin: 0 0 12px;
    line-height: 1.3;
    color: var(--sk-color-brand);
  }

  /* === BENEFITS LIST === */
  .sk-wavelength__benefits {
    list-style: none;
    padding: 0;
    margin: 0;
    text-align: left;
    margin-top: 0;
    width: 100%;
    max-width: 500px;
  }

  .sk-wavelength__benefits li {
    font-size: 16px;
    margin-bottom: 8px;
    display: flex;
    gap: 4px;
    align-items: flex-start;
    line-height: 1.3;
    color: var(--sk-color-body);
    font-weight: 400;
  }

  .sk-wavelength__benefits li::before {
    content: '';
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--sk-color-brand);
    margin-top: 6px;
  }

  /* === MOBILE SLIDER === */
  @media (max-width: 750px) {
    .sk-wavelengths__grid {
      display: none;
    }
    .sk-wavelengths__slider {
      display: block;
    }
    .sk-wavelength {
      padding: 24px 12px;
    }
    .sk-wavelength__visual {
      max-width: 420px;
    }
    .sk-wavelength__title {
      font-size: 20px;
    }
    .sk-wavelength__benefits li {
      font-size: 15px;
    }
  }
</style>

<section class="sk-wavelengths section--full-bleed sk-body-text--strong">
  <div class="page-width">
    {% if section.settings.sk_led_light_work_eyebrow != blank %}
      <p class="sk-wavelengths__eyebrow">
        {{ section.settings.sk_led_light_work_eyebrow }}
      </p>
    {% endif %}

    {% if section.settings.sk_led_light_work_heading != blank %}
      <h1 class="sk-header__section sk-section-heading sk-section-heading--h1 sk-heading-text--strong sk-heading-size--large">
        {{ section.settings.sk_led_light_work_heading }}
      </h1>
    {% endif %}

    {% liquid
      assign sk_metafield_handle = 'product.metafields.custom.led_light_work_cards'
      assign sk_cards = ''

      if product != blank and product.metafields != blank
        assign product_metafields = product.metafields
        if product_metafields.custom != blank and product_metafields.custom.led_light_work_cards != blank
          assign sk_metafield = product_metafields.custom.led_light_work_cards
          if sk_metafield.references != blank
            assign sk_cards = sk_metafield.references
          else
            assign sk_cards = sk_metafield.value | default: sk_metafield
          endif
        endif
      endif

      assign sk_cards_count = sk_cards | size
    %}

    {% if request.design_mode and product != blank and product.metafields != blank %}
      {% assign namespace_count = 0 %}
      {% for namespace in product.metafields %}
        {% assign namespace_count = namespace_count | plus: 1 %}
      {% endfor %}
      <div
        class="sk-wavelengths__debug"
        style="margin: 1rem auto 2rem; padding: 1rem; border: 1px dashed #ccc; max-width: 960px; font-size: 0.85rem;"
      >
        <p style="margin: 0 0 0.5rem;">
          <strong>Debug</strong>: product metafields namespaces listed below ({{ namespace_count }} total)
        </p>
        <details open>
          <summary style="cursor: pointer;">Show namespaces and keys</summary>
          <ul style="margin: 0.5rem 0 0; padding-left: 1.25rem;">
            {% for namespace in product.metafields %}
              {% assign namespace_name = namespace | first %}
              {% assign namespace_object = namespace | last %}
              <li>
                <code>{{ namespace_name }}</code>
                {% if namespace_object != blank %}
                  <ul style="margin: 0.25rem 0 0.5rem; padding-left: 1.25rem;">
                    {% for mf in namespace_object %}
                      <li>
                        <code>{{ namespace_name }}.{{ mf.key }}</code>
                      </li>
                    {% endfor %}
                  </ul>
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        </details>
      </div>
    {% endif %}

    {% if sk_cards_count == 0 %}
      {% if request.design_mode %}
        <p class="sk-wavelengths__empty">
          Metafeltet <code>{{ sk_metafield_handle }}</code> er tomt. Legg til metaobjekter (type
          <strong>SK_LED_LIGHT_WORK_CARD</strong>) på produktet.
        </p>
      {% endif %}
    {% else %}
      <!-- DESKTOP GRID -->
      <div class="sk-wavelengths__grid">
        {% for card in sk_cards %}
          {% liquid
            assign card_image = ''
            if card.image
              assign card_image_value = card.image.value
              assign card_image = card_image_value | default: card.image
            endif
            assign card_eyebrow = card.eyebrow.value | default: card.eyebrow
            assign card_title = card.title.value | default: card.title
            assign card_benefits = card.benefits.value | default: card.benefits
            assign card_highlight_tag = card.highlight_tag_text.value | default: card.highlight_tag_text
            assign card_show_highlight = false
            if card.show_highlight_text != null
              assign show_highlight_value = card.show_highlight_text.value
              if show_highlight_value == null
                assign card_show_highlight = card.show_highlight_text
              else
                assign card_show_highlight = show_highlight_value
              endif
            endif
          %}
          <div class="sk-wavelength">
            {% if card_show_highlight %}
              <span class="sk-tag">
                {{ card_highlight_tag | default: 'NY DYPTVIRKENDE BØLGELENGDE' }}
              </span>
            {% endif %}

            {% if card_image %}
              <div class="sk-wavelength__visual">
                <img
                  src="{{ card_image | image_url: width: 1000 }}"
                  alt="{{ card_title | default: 'Skinora LED lys' | escape }}"
                  loading="lazy"
                  width="{{ card_image.width | default: 1000 }}"
                  height="{{ card_image.height | default: 750 }}"
                >
              </div>
            {% endif %}

            {% if card_eyebrow != blank %}
              <p class="sk-wavelength__eyebrow">{{ card_eyebrow }}</p>
            {% endif %}

            {% if card_title != blank %}
              <h3 class="sk-wavelength__title">{{ card_title }}</h3>
            {% endif %}

            {% if card_benefits != blank %}
              <ul class="sk-wavelength__benefits">
                {% assign items = card_benefits | newline_to_br | split: '<br />' %}
                {% for item in items %}
                  {% assign line = item | strip %}
                  {% if line != blank %}
                    <li>{{ line }}</li>
                  {% endif %}
                {% endfor %}
              </ul>
            {% endif %}
          </div>
        {% endfor %}
      </div>

      <!-- MOBILE SWIPER -->
      <div class="sk-wavelengths__slider sk-wavelengths-swiper-{{ section.id }}">
        <div class="swiper llw-swiper-{{ section.id }}">
          <div class="swiper-wrapper">
            {% for card in sk_cards %}
              {% liquid
                assign card_image = ''
                if card.image
                  assign card_image_value = card.image.value
                  assign card_image = card_image_value | default: card.image
                endif
                assign card_eyebrow = card.eyebrow.value | default: card.eyebrow
                assign card_title = card.title.value | default: card.title
                assign card_benefits = card.benefits.value | default: card.benefits
                assign card_highlight_tag = card.highlight_tag_text.value | default: card.highlight_tag_text
                assign card_show_highlight = false
                if card.show_highlight_text != null
                  assign show_highlight_value = card.show_highlight_text.value
                  if show_highlight_value == null
                    assign card_show_highlight = card.show_highlight_text
                  else
                    assign card_show_highlight = show_highlight_value
                  endif
                endif
              %}
              <div class="swiper-slide">
                <div class="sk-wavelength">
                  {% if card_show_highlight %}
                    <span class="sk-tag">
                      {{ card_highlight_tag | default: 'NY DYPTVIRKENDE BØLGELENGDE' }}
                    </span>
                  {% endif %}

                  {% if card_image %}
                    <div class="sk-wavelength__visual">
                      <img
                        src="{{ card_image | image_url: width: 800 }}"
                        alt="{{ card_title | default: 'Skinora LED lys' | escape }}"
                        loading="lazy"
                        width="{{ card_image.width | default: 800 }}"
                        height="{{ card_image.height | default: 600 }}"
                      >
                    </div>
                  {% endif %}

                  {% if card_eyebrow != blank %}
                    <p class="sk-wavelength__eyebrow">{{ card_eyebrow }}</p>
                  {% endif %}

                  {% if card_title != blank %}
                    <h3 class="sk-wavelength__title">{{ card_title }}</h3>
                  {% endif %}

                  {% if card_benefits != blank %}
                    <ul class="sk-wavelength__benefits">
                      {% assign items = card_benefits | newline_to_br | split: '<br />' %}
                      {% for item in items %}
                        {% assign line = item | strip %}
                        {% if line != blank %}
                          <li>{{ line }}</li>
                        {% endif %}
                      {% endfor %}
                    </ul>
                  {% endif %}
                </div>
              </div>
            {% endfor %}
          </div>
          <div class="swiper-pagination"></div>
        </div>
      </div>
    {% endif %}
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    var mql = window.matchMedia('(max-width: 750px)');
    var swiperInstance = null;
    var container = document.querySelector('.sk-wavelengths-swiper-{{ section.id }} .swiper');

    function setup() {
      if (!container) return;

      if (mql.matches && !swiperInstance) {
        swiperInstance = new Swiper(container, {
          slidesPerView: 1,
          spaceBetween: 20,
          pagination: {
            el: container.querySelector('.swiper-pagination'),
            clickable: true,
          },
        });
      } else if (!mql.matches && swiperInstance) {
        swiperInstance.destroy(true, true);
        swiperInstance = null;
      }
    }

    setup();
    mql.addEventListener('change', setup);
  });
</script>

{% schema %}
{
  "name": "SK Led Light Work",
  "settings": [
    {
      "type": "text",
      "id": "sk_led_light_work_eyebrow",
      "label": "Eyebrow label",
      "default": "VITENSKAPEN BAK SKINORA LED"
    },
    {
      "type": "text",
      "id": "sk_led_light_work_heading",
      "label": "Title",
      "default": "Hvordan Fungerer Skinora LED Lys"
    }
  ],
  "presets": [
    {
      "name": "SK Led Light Work"
    }
  ]
}
{% endschema %}
