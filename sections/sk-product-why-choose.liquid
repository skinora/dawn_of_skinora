{{ 'component-image-with-text.css' | asset_url | stylesheet_tag }}

<style>
  .sk-product-why-choose-{{ section.id }} {
    background: transparent;
    padding: clamp(3rem, 4vw, 5rem) 0;
  }

  .sk-product-why-choose-{{ section.id }} .sk-why-choose__layout {
    display: grid;
    grid-template-columns: minmax(0, var(--pwc-image-width, 45%)) minmax(0, var(--pwc-text-width, 45%));
    column-gap: var(--pwc-gap, 10%);
    align-items: center;
  }

  .sk-product-why-choose-{{ section.id }} .sk-why-choose__layout--no-image {
    grid-template-columns: 1fr;
  }

  .sk-product-why-choose-{{ section.id }} .sk-why-choose__image {
    width: 100%;
    aspect-ratio: 1 / 1;
    overflow: hidden;
  }

  .sk-product-why-choose-{{ section.id }} .sk-why-choose__image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .sk-product-why-choose-{{ section.id }} .sk-why-choose__content {
    display: flex;
    flex-direction: column;
    gap: 1.25rem;
  }

  .sk-product-why-choose-{{ section.id }} .sk-product-why-choose__points {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    margin-top: 1.5rem;
  }

  .sk-product-why-choose-{{ section.id }} .sk-why-choose__point {
    display: grid;
    grid-template-columns: minmax(0, 10%) minmax(0, 1fr);
    column-gap: 10%;
    align-items: stretch;
    grid-auto-rows: minmax(0, 1fr);
  }

  .sk-product-why-choose-{{ section.id }} .sk-why-choose__point-number {
    font-size: clamp(3rem, 5vw, 5rem);
    line-height: 1;
    font-weight: 900;
    align-self: stretch;
  }

  @media (max-width: 900px) {
    .sk-product-why-choose-{{ section.id }} .sk-why-choose__layout {
      grid-template-columns: 1fr;
      column-gap: 0;
    }
    .sk-product-why-choose-{{ section.id }} .sk-why-choose__point {
      grid-template-columns: 1fr;
      column-gap: 1rem;
    }
  }

  @media (max-width: 749px) {
    .sk-product-why-choose-{{ section.id }} {
      padding: clamp(2rem, 4vw, 3rem) 0;
    }
  }
</style>

{%- assign why_choose_reference = product.metafields.custom.why_choose_reference -%}
{%- assign why_choose_entry = blank -%}
{%- assign heading = '' -%}
{%- assign subheading = '' -%}
{%- assign image_obj = blank -%}
{%- assign points = blank -%}
{%- assign show_section = false -%}

{%- if why_choose_reference != blank and why_choose_reference.value != blank -%}
  {%- assign why_choose_entry = why_choose_reference.value -%}
  {%- assign heading = why_choose_entry.heading.value | default: '' -%}
  {%- assign subheading = why_choose_entry.subheading.value | default: '' -%}
  {%- assign image_obj = why_choose_entry.image.value -%}

  {%- if why_choose_entry.points != blank and why_choose_entry.points.value != blank -%}
    {%- assign points = why_choose_entry.points.value -%}
  {%- endif -%}

  {%- if heading != blank or subheading != blank or points != blank or image_obj != blank -%}
    {%- assign show_section = true -%}
  {%- endif -%}
{%- endif -%}

{%- if show_section -%}
  <section
    class="sk-product-why-choose sk-product-why-choose-{{ section.id }}"
    style="
      --pwc-image-width: {{ section.settings.layout_image_width | default: 45 }}%;
      --pwc-text-width: {{ section.settings.layout_text_width | default: 45 }}%;
      --pwc-gap: {{ section.settings.layout_gap | default: 10 }}%;
    "
  >
    <div class="page-width">
      <div class="sk-why-choose__layout{% if image_obj == blank %} sk-why-choose__layout--no-image{% endif %}">
        {% if image_obj != blank %}
          <div class="sk-why-choose__image">
            <img
              src="{{ image_obj | image_url: width: 900 }}"
              loading="lazy"
              alt="{{ heading | default: product.title | escape }}"
              width="900"
              height="900"
            >
          </div>
        {% endif %}

        <div class="sk-why-choose__content">
          {% if heading != blank or subheading != blank %}
            <div class="sk-section-header sk-section-header--left">
              {% if heading != blank %}
                <h2 class="sk-section-heading sk-section-heading--h2 sk-heading-text--strong">
                  {{ heading | escape }}
                </h2>
              {% endif %}
              {% if subheading != blank %}
                <p class="sk-section-header__subtitle sk-heading-text--soft">
                  {{ subheading | escape }}
                </p>
              {% endif %}
            </div>
          {% endif %}

          {% if points != blank %}
            <div class="sk-product-why-choose__points">
              {% for point in points limit: 3 %}
                {% assign point_question = point.question.value | default: '' %}
                {% assign point_detail = point.point.value | default: '' %}

                {% if point_question != blank or point_detail != blank %}
                  <article class="sk-why-choose__point">
                    <span class="sk-why-choose__point-number" aria-hidden="true">
                      {{ forloop.index }}
                    </span>

                    {% if point_question != blank %}
                      <p class="sk-why-choose__point-question sk-heading-text--soft">
                        {{ point_question | escape }}
                      </p>
                    {% endif %}

                    {% if point_detail != blank %}
                      <p class="sk-why-choose__point-copy sk-heading-text--strong">
                        {{ point_detail | escape }}
                      </p>
                    {% endif %}
                  </article>
                {% endif %}
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </section>
{%- endif -%}

{% schema %}
{
  "name": "SK Product – Why Choose",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "range",
      "id": "layout_image_width",
      "label": "Image width (%)",
      "min": 30,
      "max": 60,
      "step": 1,
      "unit": "%",
      "default": 45
    },
    {
      "type": "range",
      "id": "layout_text_width",
      "label": "Text width (%)",
      "min": 30,
      "max": 60,
      "step": 1,
      "unit": "%",
      "default": 45
    },
    {
      "type": "range",
      "id": "layout_gap",
      "label": "Gap between image and text (%)",
      "min": 5,
      "max": 20,
      "step": 1,
      "unit": "%",
      "default": 10
    }
  ],
  "presets": [
    {
      "name": "SK Product – Why Choose"
    }
  ]
}
{% endschema %}
