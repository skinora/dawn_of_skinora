{{ 'component-image-with-text.css' | asset_url | stylesheet_tag }}

<style>
  .sk-product-why-choose-{{ section.id }} {
    background: transparent;
    padding: clamp(3rem, 4vw, 5rem) 0;
  }

  .sk-product-why-choose-{{ section.id }} .sk-product-why-choose__points {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 1.5rem;
    margin-bottom: clamp(1.5rem, 3vw, 3rem);
  }

  .sk-product-why-choose-{{ section.id }} .sk-why-choose__point {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .sk-product-why-choose-{{ section.id }} .sk-why-choose__point-number {
    font-size: clamp(2.2rem, 3vw, 3rem);
    line-height: 1;
    font-weight: 700;
  }

  .sk-product-why-choose-{{ section.id }} .sk-why-choose__layout {
    display: grid;
    grid-template-columns: minmax(0, var(--pwc-image-width, 45%)) minmax(0, var(--pwc-text-width, 45%));
    column-gap: var(--pwc-gap, 10%);
    align-items: center;
    gap: clamp(1rem, 3vw, 2rem);
  }

  .sk-product-why-choose-{{ section.id }} .sk-why-choose__image img {
    width: 100%;
    height: auto;
    display: block;
  }

  @media only screen and (max-width: 900px) {
    .sk-product-why-choose-{{ section.id }} .sk-why-choose__layout {
      grid-template-columns: 1fr;
    }
  }

  @media screen and (max-width: 749px) {
    .sk-section-heading {
      font-size: var(--sk-mobile-heading-size);
      line-height: var(--sk-mobile-heading-line);
    }

    .sk-product-why-choose-{{ section.id }} {
      padding: clamp(2rem, 4vw, 3rem) 0;
    }
  }
</style>

{%- assign has_content = false -%}
{%- assign why_choose_image = blank -%}
{%- assign points_list = '' -%}
{%- assign why_choose_heading = '' -%}
{%- assign why_choose_subheading = '' -%}
{%- assign why_choose_content = blank -%}
{%- assign why_choose_reference = blank -%}
{%- assign why_choose_entry = blank -%}
{%- if product != blank -%}
  {%- assign why_choose_reference = product.metafields.custom.why_choose_reference -%}
{%- endif -%}
{%- if why_choose_reference != blank and why_choose_reference.value != blank -%}
  {%- assign why_choose_entry = why_choose_reference.value -%}
{%- endif -%}
{%- if why_choose_entry != blank -%}
  {%- assign why_choose_image = why_choose_entry.image -%}
  {%- if why_choose_image != blank -%}
    {%- assign why_choose_image_alt = why_choose_image.alt | default: product.title -%}
  {%- else -%}
    {%- assign why_choose_image_alt = product.title -%}
  {%- endif -%}
  {%- if why_choose_entry.heading != blank -%}
    {%- assign why_choose_heading = why_choose_entry.heading -%}
  {%- endif -%}
  {%- if why_choose_entry.subheading != blank -%}
    {%- assign why_choose_subheading = why_choose_entry.subheading -%}
  {%- endif -%}
  {%- assign why_choose_content = why_choose_entry.content -%}
  {%- if why_choose_content != blank -%}
    {%- assign has_content = true -%}
  {%- endif -%}
  {%- if why_choose_entry.points != blank -%}
    {%- assign points_list = why_choose_entry.points -%}
  {%- endif -%}
{%- endif -%}
<section class="sk-product-why-choose sk-product-why-choose-{{ section.id }}">
  <div class="page-width">
    {% if why_choose_reference == blank %}
      <p>No `why_choose_reference` metafield present on product.</p>
    {% else %}
      <p>Reference ID: {{ why_choose_reference.id | default: 'n/a' }}</p>
      <p>Heading: {{ why_choose_heading }}</p>
      <p>Subheading: {{ why_choose_subheading }}</p>
      <p>Image URL: {{ why_choose_image | image_url: width: 900 | default: 'none' }}</p>
      <p>Content present? {{ has_content }}</p>
      <p>Points count: {{ points_list | size }}</p>
      {% if points_list != blank %}
        <ul>
          {%- for point in points_list -%}
            <li>Question: {{ point.question | escape }} – Point: {{ point.point | escape }}</li>
          {%- endfor -%}
        </ul>
      {% endif %}
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "SK Product Why Choose",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Product-Specific Control"
    },
    {
      "type": "paragraph",
      "content": "All display data should live on 'custom.why_choose_reference': this reference holds heading, subheading, image, content, and the list of Why Choose Point metaobjects so each product can manage the entire section from a single metaobject entry."
    },
    {
      "type": "paragraph",
      "content": "Heading and subheading are read solely from the reference’s 'heading' and 'subheading' fields."
    },
    {
      "type": "paragraph",
      "content": "Point data is read from 'custom.why_choose_reference.points', a List of Why Choose Point metaobjects that each expose a 'question' and 'point' field; the section renders 1-3 numbered entries."
    },
    {
      "type": "paragraph",
      "content": "The reference’s 'content' field is rendered as rich text and the 'image' field supplies the media."
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "layout_image_width",
      "label": "Image width (%)",
      "min": 30,
      "max": 60,
      "step": 1,
      "unit": "%",
      "default": 45
    },
    {
      "type": "range",
      "id": "layout_text_width",
      "label": "Text width (%)",
      "min": 30,
      "max": 60,
      "step": 1,
      "unit": "%",
      "default": 45
    },
    {
      "type": "range",
      "id": "layout_gap",
      "label": "Gap between image and text (%)",
      "min": 5,
      "max": 20,
      "step": 1,
      "unit": "%",
      "default": 10
    }
  ],
  "presets": [
    {
      "name": "SK Product Why Choose"
    }
  ]
}
{% endschema %}
