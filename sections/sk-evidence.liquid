{% comment %}
  SK Evidence & Studies
  Simple documentation page: intro, claims, studies list, safety, disclaimer.
{% endcomment %}

<style>
  .sk-evidence-{{ section.id }} {
    --sk-evidence-space-4: 4px;
    --sk-evidence-space-8: calc(var(--sk-evidence-space-4) * 2);
    --sk-evidence-space-12: calc(var(--sk-evidence-space-4) * 3);
    --sk-evidence-space-16: calc(var(--sk-evidence-space-4) * 4);
    --sk-evidence-space-20: calc(var(--sk-evidence-space-4) * 5);
    --sk-evidence-space-24: calc(var(--sk-evidence-space-4) * 6);
    --sk-evidence-space-32: calc(var(--sk-evidence-space-4) * 8);
    --sk-evidence-space-40: calc(var(--sk-evidence-space-4) * 10);

    background: rgb(var(--color-background));
    color: rgb(var(--color-foreground));
    padding-block: var(--sk-evidence-space-40);
    overflow-x: clip;
  }

  @supports not (overflow: clip) {
    .sk-evidence-{{ section.id }} {
      overflow-x: hidden;
    }
  }

  .sk-evidence-{{ section.id }} .sk-evidence__content {
    max-width: 72ch;
    margin: 0 auto;
  }

  .sk-evidence-{{ section.id }} .sk-evidence__stack {
    display: flex;
    flex-direction: column;
    gap: var(--sk-evidence-space-24);
  }

  .sk-evidence-{{ section.id }} .sk-evidence__section {
    display: flex;
    flex-direction: column;
    gap: var(--sk-evidence-space-12);
  }

  .sk-evidence-{{ section.id }} .sk-evidence__heading {
    margin: 0;
  }

  .sk-evidence-{{ section.id }} .sk-evidence__claims,
  .sk-evidence-{{ section.id }} .sk-evidence__studies {
    margin: 0;
    padding-left: var(--sk-evidence-space-20);
  }

  .sk-evidence-{{ section.id }} .sk-evidence__claims li,
  .sk-evidence-{{ section.id }} .sk-evidence__studies li {
    margin: 0 0 var(--sk-evidence-space-8);
  }

  .sk-evidence-{{ section.id }} .sk-evidence__studies li:last-child,
  .sk-evidence-{{ section.id }} .sk-evidence__claims li:last-child {
    margin-bottom: 0;
  }

  .sk-evidence-{{ section.id }} .sk-evidence__study-title {
    margin: 0;
  }

  .sk-evidence-{{ section.id }} .sk-evidence__study-meta {
    margin: 0;
    color: rgba(var(--color-foreground), 0.7);
  }

  .sk-evidence-{{ section.id }} .sk-evidence__study-note {
    margin: 0;
  }

  .sk-evidence-{{ section.id }} a {
    color: var(--color-brand);
    text-decoration: underline;
    text-underline-offset: 0.2em;
    overflow-wrap: anywhere;
  }

  .sk-evidence-{{ section.id }} a:hover {
    text-decoration-thickness: 2px;
  }

  .sk-evidence-{{ section.id }} a:focus-visible {
    outline: 2px solid var(--color-brand);
    outline-offset: 2px;
  }

  @media (max-width: 749px) {
    .sk-evidence-{{ section.id }} {
      padding-block: var(--sk-evidence-space-32);
    }

    .sk-evidence-{{ section.id }} .sk-evidence__content {
      max-width: 100%;
    }

    .sk-evidence-{{ section.id }} .sk-evidence__claims,
    .sk-evidence-{{ section.id }} .sk-evidence__studies {
      padding-left: var(--sk-evidence-space-16);
    }
  }
</style>

<main class="sk-evidence-{{ section.id }}" role="main">
  <div class="page-width">
    <div class="sk-evidence__content">
      <div class="sk-evidence__stack">
        <header class="sk-section-header sk-section-header--center">
          <h1 class="sk-section-header__title">
            {{ section.settings.heading | default: 'Dokumentasjon & forskning' | escape }}
          </h1>
          {% if section.settings.intro != blank %}
            <div class="sk-section-header__subtitle">
              {{ section.settings.intro }}
            </div>
          {% endif %}
        </header>

        {% assign claims_lines = section.settings.claims | default: '' | newline_to_br | split: '<br />' %}
        {% assign has_claims = false %}
        {% for line in claims_lines %}
          {% assign line_stripped = line | strip %}
          {% if line_stripped != blank %}
            {% assign has_claims = true %}
            {% break %}
          {% endif %}
        {% endfor %}

        {% if has_claims %}
          <section class="sk-evidence__section" aria-labelledby="sk-evidence-claims-{{ section.id }}">
            <h2
              id="sk-evidence-claims-{{ section.id }}"
              class="sk-evidence__heading sk-heading-size--medium sk-heading-text--strong"
            >
              {{ section.settings.claims_title | default: 'Påstander og evidens' | escape }}
            </h2>
            <ul class="sk-evidence__claims">
              {% for line in claims_lines %}
                {% assign claim = line | strip %}
                {% if claim != blank %}
                  <li>{{ claim | escape }}</li>
                {% endif %}
              {% endfor %}
            </ul>
          </section>
        {% endif %}

        <section class="sk-evidence__section" aria-labelledby="sk-evidence-studies-{{ section.id }}">
          <h2
            id="sk-evidence-studies-{{ section.id }}"
            class="sk-evidence__heading sk-heading-size--medium sk-heading-text--strong"
          >
            {{ section.settings.studies_title | default: 'Studier og kilder' | escape }}
          </h2>

          {% if section.blocks.size > 0 %}
            <ul class="sk-evidence__studies">
              {% for block in section.blocks %}
                {% if block.type == 'study' %}
                  <li {{ block.shopify_attributes }}>
                    <p class="sk-evidence__study-title">
                      {% if block.settings.url != blank %}
                        <a href="{{ block.settings.url }}" target="_blank" rel="nofollow noopener">
                          {{ block.settings.title | escape }}
                        </a>
                      {% else %}
                        {{ block.settings.title | escape }}
                      {% endif %}
                    </p>
                    {% if block.settings.meta != blank %}
                      <p class="sk-evidence__study-meta">{{ block.settings.meta | escape }}</p>
                    {% endif %}
                    {% if block.settings.note != blank %}
                      <p class="sk-evidence__study-note">{{ block.settings.note | escape }}</p>
                    {% endif %}
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          {% else %}
            {% if request.design_mode %}
              <p class="sk-evidence__study-meta">Ingen studier lagt til ennå.</p>
            {% endif %}
          {% endif %}
        </section>

        {% if section.settings.safety != blank %}
          <section class="sk-evidence__section" aria-labelledby="sk-evidence-safety-{{ section.id }}">
            <h2
              id="sk-evidence-safety-{{ section.id }}"
              class="sk-evidence__heading sk-heading-size--medium sk-heading-text--strong"
            >
              {{ section.settings.safety_title | default: 'Sikkerhet' | escape }}
            </h2>
            <div>
              {{ section.settings.safety }}
            </div>
          </section>
        {% endif %}

        {% if section.settings.disclaimer != blank %}
          <section class="sk-evidence__section" aria-labelledby="sk-evidence-disclaimer-{{ section.id }}">
            <h2
              id="sk-evidence-disclaimer-{{ section.id }}"
              class="sk-evidence__heading sk-heading-size--medium sk-heading-text--strong"
            >
              {{ section.settings.disclaimer_title | default: 'Ansvarsfraskrivelse' | escape }}
            </h2>
            <div>
              {{ section.settings.disclaimer }}
            </div>
          </section>
        {% endif %}
      </div>
    </div>
  </div>
</main>

{% schema %}
{
  "name": "SK Evidence",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Dokumentasjon & forskning"
    },
    {
      "type": "richtext",
      "id": "intro",
      "label": "Intro",
      "default": "<p>Her finner du en oversikt over dokumentasjon, studier og sikkerhetsinformasjon knyttet til Skinora.</p>"
    },
    {
      "type": "text",
      "id": "claims_title",
      "label": "Claims title",
      "default": "Påstander og evidens"
    },
    {
      "type": "textarea",
      "id": "claims",
      "label": "Claims (one per line)",
      "default": "Støtter hudens barrierefunksjon\nKan bidra til jevnere hudtone\nBidrar til en klarere hud over tid"
    },
    {
      "type": "text",
      "id": "studies_title",
      "label": "Studies title",
      "default": "Studier og kilder"
    },
    {
      "type": "text",
      "id": "safety_title",
      "label": "Safety title",
      "default": "Sikkerhet"
    },
    {
      "type": "richtext",
      "id": "safety",
      "label": "Safety note",
      "default": "<p>Følg alltid bruksanvisning og anbefalt frekvens. Avslutt bruk ved ubehag, og rådfør deg med helsepersonell ved behov.</p>"
    },
    {
      "type": "text",
      "id": "disclaimer_title",
      "label": "Disclaimer title",
      "default": "Ansvarsfraskrivelse"
    },
    {
      "type": "richtext",
      "id": "disclaimer",
      "label": "Disclaimer",
      "default": "<p>Informasjonen på denne siden er kun ment som generell informasjon og erstatter ikke medisinsk rådgivning.</p>"
    }
  ],
  "blocks": [
    {
      "type": "study",
      "name": "Study",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Study title"
        },
        {
          "type": "url",
          "id": "url",
          "label": "Link"
        },
        {
          "type": "text",
          "id": "meta",
          "label": "Authors / year / journal"
        },
        {
          "type": "textarea",
          "id": "note",
          "label": "Short note"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "SK Evidence"
    }
  ]
}
{% endschema %}
